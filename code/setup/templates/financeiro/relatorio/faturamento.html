{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
  <h2>Relatório de Faturamento</h2>
  <form method="get" class="row g-3 mb-4">
    <div class="col-md-4">
      <label for="data_inicio" class="form-label">Data Início</label>
      <input type="date" id="data_inicio" name="data_inicio" value="{{ data_inicio }}" class="form-control">
    </div>
    <div class="col-md-4">
      <label for="data_fim" class="form-label">Data Fim</label>
      <input type="date" id="data_fim" name="data_fim" value="{{ data_fim }}" class="form-control">
    </div>
    <div class="col-md-4 d-flex align-items-end">
      <button type="submit" class="btn btn-primary me-2">Gerar</button>
      {% if titulos %}
        <a href="?data_inicio={{ data_inicio }}&data_fim={{ data_fim }}&exportar=pdf" class="btn btn-danger me-2">Exportar PDF</a>
        <a href="?data_inicio={{ data_inicio }}&data_fim={{ data_fim }}&exportar=csv" class="btn btn-success">Exportar Excel (CSV)</a>
      {% endif %}
    </div>
  </form>

  {% if titulos %}
  <table class="table table-bordered table-hover">
    <thead class="table-light">
      <tr>
        <th>Descrição</th>
        <th>Valor (R$)</th>
        <th>Data Pagamento</th>
      </tr>
    </thead>
    <tbody>
      {% for t in titulos %}
      <tr>
        <td>{{ t.descricao }}</td>
        <td>{{ t.valor }}</td>
        <td>{{ t.data_pagamento|date:"d/m/Y" }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  <div class="mt-3">
    <strong>Total:</strong> R$ {{ total }}<br>
    <strong>Quantidade:</strong> {{ quantidade }}<br>
    <strong>Média:</strong> R$ {{ media }}
  </div>
  {% else %}
    <p>Nenhum dado encontrado para o período informado.</p>
  {% endif %}
</div>
{% endblock %}
